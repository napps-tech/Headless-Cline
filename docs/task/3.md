# エントリーポイントの作成

## 概要

npm run cline -d 1.md でCline.tsをインスタンス化し実行するコードを用意します。

## 実装計画

### 1. 新規ファイルの作成

#### src/cli.ts
CLIのエントリーポイントとなるファイルを作成します。

```typescript
#!/usr/bin/env node
import { Cline } from './core/Cline'
import { VscodePuppeteerUrlContentFetcher } from './services/browser/UrlContentFetcher'
import { VscodeTerminalManager } from './integrations/terminal/TerminalManager'
import { VscodeBrowserSession } from './services/browser/BrowserSession'
import { VscodeDiffViewProvider } from './integrations/editor/DiffViewProvider'
import { ShellProvider } from './core/integrations/platform'
import fs from 'fs/promises'
import path from 'path'

async function main() {
  const args = process.argv.slice(2)
  const docIndex = args.indexOf('-d')
  
  if (docIndex === -1 || !args[docIndex + 1]) {
    console.error('Usage: npm run cline -d <document.md>')
    process.exit(1)
  }

  const docPath = args[docIndex + 1]
  
  try {
    const content = await fs.readFile(path.resolve(process.cwd(), docPath), 'utf-8')
    
    const cline = new Cline(
      provider,
      new VscodePuppeteerUrlContentFetcher(),
      new VscodeTerminalManager(),
      new VscodeBrowserSession(),
      new VscodeDiffViewProvider(),
      new ShellProvider(),
      {
        model: 'claude-3-sonnet-20240229',
        provider: 'anthropic',
        apiKey: process.env.ANTHROPIC_API_KEY
      },
      undefined,
      false,
      undefined,
      content
    )

    // タスクの実行を待機
    await new Promise<void>((resolve) => {
      cline.on('taskComplete', () => {
        resolve()
      })
    })

  } catch (error) {
    console.error('Error:', error)
    process.exit(1)
  }
}

main()
```

### 2. package.jsonの更新

scriptsセクションとbinセクションを追加します：

```json
{
  "scripts": {
    "cline": "node dist/cli.js"
  },
  "bin": {
    "cline": "./bin/cline"
  }
}
```

### 3. 実行可能なCLIスクリプトの作成

bin/clineファイルを作成し、実行権限を付与します：

```bash
#!/usr/bin/env node
require('../dist/cli.js')
```

## 実装手順

1. src/cli.tsファイルを作成
2. package.jsonを更新
3. bin/clineスクリプトを作成
4. 必要な依存関係をインストール
5. コードのビルドとテスト
6. CLIコマンドの動作確認

## 注意点

- ANTHROPIC_API_KEYの環境変数が必要
- TypeScriptのビルド設定の確認
- エラーハンドリングの実装
- CLIインターフェースの使いやすさ